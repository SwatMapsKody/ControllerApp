<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Database View</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 10px;
            text-align: left;
        }

        h1 {
            text-align: center;
        }
    </style>
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
    <script>
        tinymce.init({
            selector: '.tinymce-editor',  // Apply TinyMCE to elements with the class `tinymce-editor`
            menubar: false,
            plugins: 'advlist autolink lists link image charmap preview anchor searchreplace visualblocks code fullscreen insertdatetime media table paste help wordcount',
            toolbar: 'undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help',
            height: 500,
            branding: false
        });
    </script>
</head>
<body>
    <h1>Database Records</h1>

    <h2>Controller Manufacturers</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
            </tr>
        </thead>
        <tbody>
            {% for manufacturer in manufacturers %}
            <tr>
                <td>{{ manufacturer.id }}</td>
                <td>{{ manufacturer.name }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2>Controllers</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Manufacturer</th>
                <th>Model</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            {% for controller in controllers %}
            <tr>
                <td>{{ controller.id }}</td>
                <td>{{ controller.manufacturer.name }}</td>
                <td>{{ controller.model }}</td>
                <td>
                    <form method="post" action="{% url 'update_controller_description' controller.id %}">
                        {% csrf_token %}
                        <textarea name="description" class="tinymce-editor">{{ controller.description }}</textarea>
                        <button type="submit">Save</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2>Support Workflows</h2>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Controller</th>
                <th>Question</th>
                <th>Answer</th>
            </tr>
        </thead>
        <tbody>
            {% for workflow in workflows %}
            <tr>
                <td>{{ workflow.id }}</td>
                <td>{{ workflow.controller.model }}</td>
                <td>{{ workflow.question }}</td>
                <td>
                    <form method="post" action="{% url 'update_workflow_answer' workflow.id %}">
                        {% csrf_token %}
                        <textarea name="answer" class="tinymce-editor">{{ workflow.answer|safe }}</textarea>
                        <button type="submit">Save</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
